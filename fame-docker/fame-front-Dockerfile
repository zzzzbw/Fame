FROM node:10.10.0-alpine

MAINTAINER zzzzbw "zzzzbw@gmail.com"

ARG BASE_URL
ARG PROXY_HOST
ARG PROXY_PORT
ARG ICP
ARG GOOGLE_SITE_VERIFICATION
ARG GOOGLE_ANALYTICS

ENV BASE_URL $BASE_URL
ENV PROXY_HOST $PROXY_HOST
ENV PROXY_PORT $PROXY_PORT
ENV ICP $ICP
ENV GOOGLE_SITE_VERIFICATION $GOOGLE_SITE_VERIFICATION
ENV GOOGLE_ANALYTICS $GOOGLE_ANALYTICS

RUN npm config set registry https://registry.npm.taobao.org

ENV HOST 0.0.0.0
ENV NODE_ENV=production

WORKDIR /app

COPY ./fame-front/package.json ./
RUN npm install

COPY ./fame-front .

RUN npm run build

EXPOSE 3000

CMD ["npm","run","start"]